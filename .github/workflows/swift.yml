name: Run Test

on:
  # develop ë¸Œëœì¹˜ì— push ë‚˜ pull request ì´ë²¤íŠ¸ê°€ ì¼ì–´ë‚¬ì„ë•Œ í•´ë‹¹ workflow ë¥¼ trigger
  push:
    branches: [ develop ]
  pull_request:
    branches: [ develop ]

jobs:
  build:
    runs-on: macos-14

    steps:
    - name: List Xcode installations
      run: sudo ls -1 /Applications | grep "Xcode"
    - name: Select Xcode 15.3
      run: sudo xcode-select -s /Applications/Xcode_15.3.app/Contents/Developer
    - uses: actions/checkout@v3
    # SPM Caching
    - name: Cache packages
      uses: actions/cache@v3
      id: spm-cache
      with:
        path: .build
        key: ${{ runner.os }}-spm-${{ hashFiles('**/Package.resolved') }}
    - if: steps.spm-cache.outputs.cache-hit == 'true'
      run: echo 'spm cache hit!'
    - if: steps.spm-cache.outputs.cache-hit != 'true'
      run: echo 'spm cache missed!'
    # shell ì´ìš©í•´ì„œ í•˜ë‚˜ì˜ command ìˆ˜í–‰
    - name: Start xcode build ğŸ› 
      run: |
        xcodebuild clean test -project RefactorMoti/RefactorMoti.xcodeproj \
        -scheme RefactorMoti \
        -destination 'platform=iOS Simulator,name=iPhone 15,OS=latest'

